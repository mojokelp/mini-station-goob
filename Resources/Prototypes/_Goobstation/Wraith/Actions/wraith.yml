# Этот файл содержит все действия для Рейта.
# Оборотни и другие роли призраков должны быть в отдельной директории вне папки Рейта.

#   - type: ActionWraithPoints -> Удаляет Очки Рейта при использовании действия
#    wpConsume: int -> Количество Очков Рейта для удаления

# Базовые действия Рейта
- type: entity # Не используется - Требуется переработка системы призраков для многоразовых действий
  parent: ActionToggleGhostHearing
  id: ActionToggleGhostHearingWraith
  components:
  - type: Action
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: hide_chat
    iconOn: _Goobstation/Wraith/actions.rsi/show_chat.png

- type: entity
  id: ActionHaunt
  name: Вселяться
  description: Станьте материальным на 30 секунд. В это время вы получаете дополнительные очки рейта в зависимости от количества людей поблизости. Используйте эту способность повторно, будучи материальным, чтобы раствориться в эфире.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithhaunt.ogg
    useDelay: 30
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: haunt
  - type: InstantAction
    event: !type:HauntEvent

- type: entity
  id: ActionWhisper
  parent: DemonicWhisperAction
  name: Шёпот
  description: Отправьте эфирное сообщение живому существу.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithwhisper2.ogg
    useDelay: 2
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: whisper

- type: entity
  id: ActionBloodWriting
  name: Кровавые Письмена
  description: Напишите жуткий символ на земле.
  components:
  - type: Action
    useDelay: 5
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blood_writing
  - type: InstantAction
    event: !type:BloodWritingEvent

- type: entity
  id: ActionAbsorbCorpse
  name: Поглотить труп
  description: Украдите жизненную силу из трупа. Нельзя использовать на скелете!
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithsoulsucc1.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: absorb_corpse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      requireAll: true
      components:
      - MobState
      - HumanoidAppearance
    blacklist:
      components:
      - PartialAbsorbable
    event: !type:AbsorbCorpseEvent
  - type: ActionWraithPoints
    wpConsume: 20
  - type: ActionUseDelayOnUse
    useDelayAccumulator: 45

- type: entity
  id: ActionSpook
  name: Пугать
  description: Вызовите жуткие, странные и пугающие события в области вокруг себя. Используйте эту способность, чтобы создать сущность как источник этих событий, затем взаимодействуйте с ней, чтобы выбрать конкретное действие.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithspook1.ogg
    itemIconStyle: BigAction
    useDelay: 30
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: spook
  - type: TargetAction
    range: 10
  - type: WorldTargetAction
    event: !type:SpookEvent
  - type: ActionWraithPoints
    wpConsume: 20

- type: entity
  id: ActionDecay
  name: Разложение
  description: Заставьте человека потерять выносливость или механизм выйти из строя.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: decay
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    blacklist:
      components:
      - BorgChassis
      - BibleUser
    event: !type:DecayEvent
  - type: ActionWraithPoints
    wpConsume: 30

- type: entity
  id: ActionCommand
  name: Командовать
  description: Прикажите нескольким предметам полететь в указанную локацию.
  components:
  - type: Action
    useDelay: 40
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: command
  - type: TargetAction
    range: 10
  - type: EntityTargetAction
    canTargetSelf: false
    blacklist:
      components:
      - BibleUser
    event: !type:WraithCommandEvent
  - type: ActionWraithPoints
    wpConsume: 50

- type: entity
  id: ActionAnimateObject
  parent: ActionAnimateSpell
  name: Оживить предмет
  description: Оживите неодушевлённый предмет, чтобы он атаковал ближайших людей.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithlivingobject.ogg
    useDelay: 60
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: anim_object
  - type: ActionWraithPoints
    wpConsume: 200

- type: entity
  id: ActionPossessObject
  name: Овладеть предметом
  description: Вселитесь и возьмите под контроль обычный предмет. Уровень переполоха: высокий.
  components:
  - type: ActionWraithPoints
    wpConsume: 300
  - type: Action
    itemIconStyle: BigAction
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: possess_object
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    whitelist:
      components:
      - Animateable # В настоящее время: SeatBase, TableBase, ClosetBase, BaseMachine, ConstructibleMachine, BaseComputer, BaseItem, CrateGeneric, StorageTank, GasCanister
    blacklist:
      components:
      - NukeDisk
      - GravityGenerator
      - AnomalyGenerator
      - TegGenerator
      - TegCirculator
      - XenoArtifact
      - Ghost
      - Spectral
      - FadingTimedDespawn
      - TimedDespawn
    event: !type:PossessObjectEvent
      toAdd:
      - type: Animate
      - type: MindContainer
      - type: InputMover
      - type: MobMover
      - type: CombatMode
      - type: MeleeWeapon
        animation: Slash
        wideAnimation: WeaponArcClaw
        altDisarm: false
        soundHit:
          collection: Flesh_Stab
        range: 1.5
        angle: 0.0
        damage:
          types:
            Slash: 20
      - type: NpcFactionMember
        factions:
        - Wraith
      - type: NoSlip
      - type: MovementSpeedModifier
        baseWalkSpeed: 5
        baseSprintSpeed: 5
      - type: MovementAlwaysTouching
      - type: CanMoveInAir
      - type: Damageable
        damageContainer: ManifestedSpirit
        damageModifierSet: ManifestedSpirit
      - type: Destructible
        thresholds:
        - trigger:
            !type:DamageTrigger
            damage: 300 #Легко убивается святым уроном, поэтому должно быть довольно высоко, чтобы риск был оправдан
          behaviors:
          - !type:DoActsBehavior
            acts: ["Destruction"]
          - !type:PlaySoundBehavior
            sound:
              collection: MetalBreak
      - type: Hands
      - type: CanEscapeInventory
      - type: MobCollision
      - type: LanguageSpeaker
      - type: UniversalLanguageSpeaker
      - type: Speech
        speechVerb: Ghost
      toRemove:
      - RequireProjectileTarget
      - BlockMovement
      - Item
      - MeleeRequiresWield

- type: entity
  id: ActionEvolve
  name: Эволюционировать
  description: Выберите форму для эволюции после поглощения как минимум 3 душ.
  components:
  - type: Action
    useDelay: 0
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: evolve
  - type: InstantAction
    event: !type:WraithEvolveEvent
  - type: ActionWraithPoints
    wpConsume: 150

# Действия Вестника Бездны
- type: entity
  id: ActionRaiseSkeleton
  name: Поднять скелет
  description: Воскресите окостеневшее мёртвое тело или наполните шкаф неистребимым скелетом-слугой.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithraise1.ogg
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: skeleton
  - type: TargetAction
    range: 15
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      components:
      - EntityStorage
      - HumanoidAppearance
    event: !type:RaiseSkeletonEvent
  - type: ActionWraithPoints
    wpConsume: 100

- type: entity
  id: ActionSummonVoidPortal
  name: Призвать портал Бездны
  description: Призовите портал Бездны, из которого хлынут потусторонние существа.
  components:
  - type: ConfirmableAction
    popup: wraith-portal-already
    primeTime: 10
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithportal.ogg
    useDelay: 180
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: open_portal
  - type: InstantAction
    event: !type:SummonPortalEvent
  - type: ActionUserWhitelist
    whitelist:
      components:
      - Corporeal
    popup: wraith-must-be-corporeal
  - type: ActionWraithPoints
    wpConsume: 150

- type: entity
  id: ActionSummonVoidCreature
  name: Призвать созданий Бездны
  description: Попытайтесь прорвать завесу между мирами, чтобы позволить низшему созданию Бездны проникнуть в этот мир.
  components:
  - type: Action
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_creature
  - type: InstantAction
    event: !type:SummonVoidCreatureEvent
  - type: ActionWraithPoints
    wpConsume: 400

- type: entity
  id: ActionMakeRevenant
  name: Создать Оборотня
  description: Возьмите под контроль целый труп в виде могущественного Оборотня! Позже вы не сможете поглотить этот труп. Как Оборотень, вы получаете повышенную генерацию очков, но ваши способности Оборотня стоят намного больше обычных.
  components:
  - type: Action
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: revenant
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:MakeRevenantEvent
  - type: ActionWraithPoints
    wpConsume: 1000

# Действия Чумоносца

- type: entity
  id: BaseCurseAction
  parent: BaseAction
  components:
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    whitelist:
      requireAll: true
      components:
      - StatusEffects
      - Body
    canTargetSelf: false
    event: !type:ApplyCurseActionEvent
  - type: CurseAction # обновляет все проклятия при использовании любого проклятия
  - type: ActionWraithPoints
    wpConsume: 40


- type: entity
  id: ActionCurseBlindness
  name: Проклятие Слепоты
  parent: BaseCurseAction
  description: Прокляните живого слепотой.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blind_curse
  - type: EntityTargetAction
    event: !type:ApplyCurseActionEvent
      curse: CurseBlindness
      popup: curse-popup-blindness

- type: entity
  id: ActionCurseWeakness
  name: Проклятие Слабости
  parent: BaseCurseAction
  description: Прокляните живого слабостью. Замедляет цель и вызывает у неё головокружение.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: weak_curse
  - type: EntityTargetAction
    event: !type:ApplyCurseActionEvent
      curse: CurseWeakness
      popup: curse-popup-weakness
      # todo: звук для цели

- type: entity
  id: ActionCurseBlood
  name: Проклятие Крови
  parent: BaseCurseAction
  description: Прокляните живого чумой крови.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blood_curse
  - type: EntityTargetAction
    event: !type:ApplyCurseActionEvent
      curse: CurseBlood
      popup: curse-popup-blood

- type: entity
  id: ActionCurseRot
  name: Проклятие Гнили
  parent: BaseCurseAction
  description: Прокляните живого потусторонней чумой.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: rot_curse
  - type: EntityTargetAction
    event: !type:ApplyCurseActionEvent
      curse: CurseRot
      popup: curse-popup-rot

- type: entity
  id: ActionCurseDeath
  name: Проклятие Смерти
  parent: BaseCurseAction
  description: Пожните душу полностью проклятого существа!
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: death_curse
  - type: EntityTargetAction
    event: !type:ApplyCurseActionEvent
      curse: CurseDeath
      popup: curse-popup-death
      requireAllCurses: true
  - type: ActionWraithPoints
    wpConsume: 80

- type: entity
  id: ActionDefile
  name: Осквернить
  description: Создайте ужасный яд внутри пищевого продукта или контейнера. Сначала используйте на себе, чтобы выбрать химикат.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 50
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: wraith_poison
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    event: !type:DefileEvent
  - type: ActionWraithPoints
    wpConsume: 50

- type: entity
  id: ActionSummonPlagueRat
  name: Призвать Чумную Крысу
  description: Попытайтесь прорвать завесу между мирами, чтобы позволить чумной крысе проникнуть в этот мир.
  components:
  - type: Action
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_rats
  - type: InstantAction
    event: !type:SummonPlagueRatEvent

- type: entity
  id: ActionSummonRotHulk
  name: Призвать Гуль-Гниющего
  description: Ассимилируйте грязь в области и создайте нестабильного слугу.
  components:
  - type: Action
    useDelay: 90
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_goo
  - type: InstantAction
    event: !type:SummonRotHulkEvent
  - type: ActionWraithPoints
    wpConsume: 120

# Действия Трикстера (Плута/Обманщика)
